/*! For license information please see bundle.e46ce453227b50e68848.js.LICENSE.txt */
(()=>{"use strict";function t(){var e,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(t,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return n(l,"_invoke",function(t,n,o){var i,a,c,s=0,l=o||[],f=!1,d={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return i=t,a=0,c=e,d.n=n,u}};function v(t,n){for(a=t,c=n,r=0;!f&&s&&!o&&r<l.length;r++){var o,i=l[r],v=d.p,p=i[2];t>3?(o=p===n)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=v&&((o=t<2&&v<i[1])?(a=0,d.v=n,d.n=i[1]):v<p&&(o=t<3||i[0]>n||n>p)&&(i[4]=t,i[5]=n,d.n=p,a=0))}if(o||t>1)return u;throw f=!0,n}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,p),a=l,c=p;(r=a<2?e:c)||!f;){i||(a?a<3?(a>1&&(d.n=-1),v(a,c)):d.n=c:d.v=c);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((r=(f=d.n<0)?c:t.call(n,d))!==u)break}catch(t){i=e,a=1,c=t}finally{s=1}}return{value:r,done:f}}}(t,i,a),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var d=[][i]?r(r([][i]())):(n(r={},i,function(){return this}),r),v=f.prototype=s.prototype=Object.create(d);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t}return l.prototype=f,n(v,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,a,"GeneratorFunction"),n(v),n(v,a,"Generator"),n(v,i,function(){return this}),n(v,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:p}})()}function n(t,e,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}n=function(t,e,r,o){function a(e,r){n(t,e,function(t){return this._invoke(e,r,t)})}e?i?i(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r:(a("next",0),a("throw",1),a("return",2))},n(t,e,r,o)}function e(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function r(t){return function(){var n=this,r=arguments;return new Promise(function(o,i){var a=t.apply(n,r);function c(t){e(a,o,i,c,u,"next",t)}function u(t){e(a,o,i,c,u,"throw",t)}c(void 0)})}}function o(t){return i.apply(this,arguments)}function i(){return(i=r(t().m(function n(e){var r,o,i;return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,new Promise(function(t){return setTimeout(t,1e3)});case 1:return t.n=2,fetch("https://api.openweathermap.org/data/2.5/weather?units=metric&q=".concat(e,"&appid=").concat("97d93f1704dcb8e35dd2045c8e75710d"));case 2:return r=t.v,i=JSON,t.n=3,r.text();case 3:return o=i.parse.call(i,t.v),t.a(2,o)}},n)}))).apply(this,arguments)}function a(){return c.apply(this,arguments)}function c(){return c=r(t().m(function n(){return t().w(function(n){for(;;)switch(n.n){case 0:if(navigator.geolocation){n.n=1;break}throw new Error("couldnt get geolocation");case 1:return n.a(2,new Promise(function(n,e){navigator.geolocation.getCurrentPosition(function(){var o=r(t().m(function r(o){var i,a,c,u,s,l;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return i=o.coords.latitude,a=o.coords.longitude,t.p=1,t.n=2,fetch("https://api.openweathermap.org/geo/1.0/reverse?lat=".concat(i,"&lon=").concat(a,"&limit=1&appid=").concat("97d93f1704dcb8e35dd2045c8e75710d"));case 2:return c=t.v,t.n=3,c.json();case 3:(u=t.v)&&u.length>0?(s=u[0].name,localStorage.setItem("geoPermission","granted"),n(s)):e(new Error("City not found for this location")),t.n=5;break;case 4:t.p=4,l=t.v,e(new Error("Failed to get a City name",l));case 5:return t.a(2)}},r,null,[[1,4]])}));return function(t){return o.apply(this,arguments)}}(),function(t){switch(t.code){case 1:e(new Error("User denied the request for Geolocation."));break;case 2:e(new Error("Location information is unavailable."));break;case 3:e(new Error("The request to get user location timed out."));break;default:e(new Error("An unknown error occurred"))}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}))}},n)})),c.apply(this,arguments)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var n=function(t){if("object"!=u(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=u(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(n)?n:n+""}const f=new(function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.events={}},(n=[{key:"on",value:function(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}},{key:"off",value:function(t,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==n}))}},{key:"emit",value:function(t,n){this.events[t]&&this.events[t].forEach(function(t){t(n)})}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}());function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function v(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function p(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var n=function(t){if("object"!=d(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=d(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(n)?n:n+""}const y=new(function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.routes=[],this.currentRoute=null,this.params={},this.basePath=this.getBasePath()},n=[{key:"getBasePath",value:function(){var t=window.location.pathname,n=window.location.hostname;if("ifa-01.github.io"!==n&&!n.endsWith(".github.io"))return"";for(var e=0,r=["/HomeWork-WeatherApp-hw07"];e<r.length;e++){var o=r[e];if(t.startsWith(o))return o}return""}},{key:"normalizePath",value:function(t){return this.basePath&&t.startsWith(this.basePath)?t.slice(this.basePath.length)||"/":t}},{key:"addRoute",value:function(t,n){this.routes.push({path:t,handler:n})}},{key:"matchRoute",value:function(t,n){if("/"===t&&"/"===n)return{};var e=t.split("/").filter(function(t){return""!==t}),r=n.split("/").filter(function(t){return""!==t});if(e.length!==r.length)return null;for(var o={},i=0;i<e.length;i++)if(e[i].startsWith(":"))o[e[i].slice(1)]=decodeURIComponent(r[i]);else if(e[i]!==r[i])return null;return o}},{key:"updateActiveNav",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||window.location.pathname,n=this.normalizePath(t);document.querySelectorAll(".nav-link").forEach(function(t){var e=t.getAttribute("href");e===n||"/"===e&&"/"===n?t.classList.add("active"):t.classList.remove("active")})}},{key:"navigate",value:function(){var t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||window.location.pathname,e=this.normalizePath(n),r="/"===e?"/":e.replace(/^\/+|\/+$/g,""),o=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return v(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?v(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw i}}}}(this.routes);try{for(o.s();!(t=o.n()).done;){var i=t.value,a="/"===i.path?"/":i.path.replace(/^\/+|\/+$/g,""),c=this.matchRoute(a,r);if(null!==c){this.currentRoute=i,this.params=c,i.handler(c);var u="/"===e?"/":e;return void this.updateActiveNav(u)}}}catch(t){o.e(t)}finally{o.f()}"/"!==e&&this.navigate("/")}},{key:"go",value:function(t){var n=this.basePath?"".concat(this.basePath).concat(t):t;window.history.pushState({},"",n),this.navigate(n)}},{key:"init",value:function(){var t=this;window.addEventListener("popstate",function(){t.navigate()}),document.addEventListener("click",function(n){var e=n.target.closest("a[data-router]");if(e){n.preventDefault();var r=e.getAttribute("href");t.go(r)}});var n=sessionStorage.getItem("redirectPath");n?(sessionStorage.removeItem("redirectPath"),this.go(n)):this.navigate()}}],n&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}());function m(){return document.getElementById("router-content")}function b(){var t=m();t&&(t.innerHTML="")}function g(t,n){var e;b();var r='\n    <div class="weather-info show">\n      <div class="location" id="location">'.concat(t,'</div>\n      <div class="temp" id="temperature">').concat(Math.round(n.main.temp),'°C</div>\n      <div class="description" id="description">').concat(n.weather[0].description,'</div>\n\n      <div class="details">\n        <div class="detail">\n          <i class="fas fa-wind"></i>\n          <div id="wind">').concat((null===(e=n.wind)||void 0===e?void 0:e.speed)||0,' м/с</div>\n        </div>\n        <div class="detail">\n          <i class="fas fa-tint"></i>\n          <div id="humidity">').concat(n.main.humidity,'%</div>\n        </div>\n        <div class="detail">\n          <i class="fas fa-temperature-high"></i>\n          <div id="feelsLike">').concat(Math.round(n.main.feels_like),'°C</div>\n        </div>\n      </div>\n    </div>\n\n    <div class="back-button-container">\n      <button class="back-btn" id="backBtn">\n        <i class="fas fa-arrow-left"></i> Назад\n      </button>\n    </div>\n  '),o=m();if(o){o.innerHTML=r;var i=document.getElementById("backBtn");i&&i.addEventListener("click",function(){window.history.back()})}}function w(t){var n=document.getElementById("historyList");n&&(t&&0!==t.length?n.innerHTML=t.map(function(t){return'\n      <div class="history-item">\n        <a href="/city/'.concat(encodeURIComponent(t),'" data-router class="history-link">\n          <i class="fas fa-map-marker-alt"></i> ').concat(t,"\n        </a>\n      </div>\n    ")}).join(""):n.innerHTML='<p class="no-history">История пуста</p>')}function k(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return S(s,"_invoke",function(e,r,o){var i,c,u,s=0,l=o||[],f=!1,d={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(n,e){return i=n,c=0,u=t,d.n=e,a}};function v(e,r){for(c=e,u=r,n=0;!f&&s&&!o&&n<l.length;n++){var o,i=l[n],v=d.p,p=i[2];e>3?(o=p===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=v&&((o=e<2&&v<i[1])?(c=0,d.v=r,d.n=i[1]):v<p&&(o=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,d.n=p,c=0))}if(o||e>1)return a;throw f=!0,r}return function(o,l,p){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&v(l,p),c=l,u=p;(n=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(d.n=-1),v(c,u)):d.n=u:d.v=u);try{if(s=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(f=d.n<0)?u:e.call(r,d))!==a)break}catch(n){i=t,c=1,u=n}finally{s=1}}return{value:n,done:f}}}(e,o,i),!0),s}var a={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(S(n={},r,function(){return this}),n),f=s.prototype=c.prototype=Object.create(l);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,S(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,S(f,"constructor",s),S(s,"constructor",u),u.displayName="GeneratorFunction",S(s,o,"GeneratorFunction"),S(f),S(f,o,"Generator"),S(f,r,function(){return this}),S(f,"toString",function(){return"[object Generator]"}),(k=function(){return{w:i,m:d}})()}function S(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}S=function(t,n,e,r){function i(n,e){S(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},S(t,n,e,r)}function P(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function E(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){P(i,r,o,a,c,"next",t)}function c(t){P(i,r,o,a,c,"throw",t)}a(void 0)})}}function O(){var t=document.getElementById("cityInput"),n=document.getElementById("cityBtn"),e=document.getElementById("geoBtn");if(n&&t){var r=n.cloneNode(!0);n.parentNode.replaceChild(r,n),r.addEventListener("click",E(k().m(function n(){var e,r,i;return k().w(function(n){for(;;)switch(n.p=n.n){case 0:if(e=t.value.trim()){n.n=1;break}return f.emit("error","Введите название города"),n.a(2);case 1:return f.emit("loading",!0),n.p=2,n.n=3,o(e);case 3:r=n.v,f.emit("weather:loaded",{city:e,weather:r}),y.go("/city/".concat(encodeURIComponent(e))),n.n=5;break;case 4:n.p=4,i=n.v,f.emit("error",i);case 5:return n.p=5,f.emit("loading",!1),n.f(5);case 6:return n.a(2)}},n,null,[[2,4,5,6]])})))}if(e){var i=e.cloneNode(!0);e.parentNode.replaceChild(i,e),i.addEventListener("click",E(k().m(function t(){var n,e,r;return k().w(function(t){for(;;)switch(t.p=t.n){case 0:return f.emit("loading",!0),t.p=1,t.n=2,a();case 2:return n=t.v,t.n=3,o(n);case 3:e=t.v,f.emit("weather:loaded",{city:n,weather:e}),y.go("/city/".concat(encodeURIComponent(n))),t.n=5;break;case 4:t.p=4,r=t.v,f.emit("error",r);case 5:return t.p=5,f.emit("loading",!1),t.f(5);case 6:return t.a(2)}},t,null,[[1,4,5,6]])})))}}function j(){y.addRoute("/",function(){(function(){b();var t=m();t&&(t.innerHTML='\n    <div class="input-group">\n      <input type="text" id="cityInput" placeholder="Введите город" />\n    </div>\n\n    <div class="buttons">\n      <button class="city-btn" id="cityBtn">\n        <i class="fas fa-city"></i> По городу\n      </button>\n      <button class="geo-btn" id="geoBtn">\n        <i class="fas fa-location-arrow"></i> По геолокации\n      </button>\n    </div>\n\n    <div class="loading" id="loading" style="display: none;">\n      <i class="fas fa-spinner fa-spin"></i> Загрузка...\n    </div>\n\n    <div class="error" id="error" style="display: none;">\n      Город не найден. Проверьте правильность написания.\n    </div>\n\n    <div class="history-section" id="historySection">\n      <h3>История поиска</h3>\n      <div class="history-list" id="historyList"></div>\n    </div>\n  ',w(JSON.parse(localStorage.getItem("weatherHistory")||"[]")))})(),setTimeout(O,0)}),y.addRoute("/city/:cityName",function(){var t=E(k().m(function t(n){var e,r,i;return k().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=decodeURIComponent(n.cityName),f.emit("loading",!0),t.p=1,t.n=2,o(e);case 2:r=t.v,g(e,r),f.emit("weather:loaded",{city:e,weather:r}),t.n=4;break;case 3:t.p=3,i=t.v,f.emit("error",i),y.go("/");case 4:return t.p=4,f.emit("loading",!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}));return function(n){return t.apply(this,arguments)}}()),y.addRoute("/about",function(){!function(){b();var t=m();if(t){t.innerHTML='\n    <div class="about-content">\n      <h2>О приложении</h2>\n      <p>\n        Приложение "Погода" позволяет узнать текущую погоду в любом городе мира.\n      </p>\n      <p>\n        Вы можете найти погоду по названию города или использовать геолокацию\n        для определения погоды в вашем текущем местоположении.\n      </p>\n      <p>\n        Приложение использует API OpenWeatherMap для получения актуальных\n        данных о погоде.\n      </p>\n      <div class="back-button-container">\n        <button class="back-btn" id="backBtn">\n          <i class="fas fa-arrow-left"></i> Назад\n        </button>\n      </div>\n    </div>\n  ';var n=document.getElementById("backBtn");n&&n.addEventListener("click",function(){window.history.back()})}}()}),y.init()}f.on("weather:loaded",function(t){var n,e;n=t.city,(e=(e=JSON.parse(localStorage.getItem("weatherHistory")||"[]")).filter(function(t){return t!==n})).unshift(n),e=e.slice(0,10),localStorage.setItem("weatherHistory",JSON.stringify(e)),w(e)}),f.on("error",function(t){var n,e;n=t.message||t,(e=document.getElementById("error"))?(e.textContent=n,e.style.display="block",setTimeout(function(){e.style.display="none"},5e3)):alert(n)}),f.on("loading",function(t){!function(t){var n=document.getElementById("loading");n&&(n.style.display=t?"block":"none")}(t)}),"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",j):j())})();